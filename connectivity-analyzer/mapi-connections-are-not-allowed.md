---
title: MAPI Connections are Not Allowed
author: bradhugh
ms.author: bradhugh
manager: tpolitis
audience: ITPro 
ms.topic: article 
ms.service: remote-connect-tool
localization_priority: Normal
description: 
---

<div data-xmlns="https://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="https://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">

# MAPI Connections are Not Allowed

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Topic Last Modified:** 2010-06-21_

The Microsoft Remote Connectivity Analyzer queries the Exchange Server and attempts to connect using RPC over HTTP. If MAPI connections are disabled on an Exchange Server 2007 or Exchange 2010, then you may receive the following error.

"The server disallows the user to access the server via the MAPI protocol interface."

This functionality is expected to be of value to providers of hosting services that want to force their end users to connect to Exchange using Outlook Web Access but not Outlook (via regular MAPI connection or RPC over HTTP). However, if this functionality is enabled, then the Microsoft Remote Connectivity Analyzer (ExRCA) tool will fail when testing RPC over HTTP or Outlook Anywhere connections.

If you have configured your Exchange 2007 or Exchange 2010 server to prevent MAPI connections, then end users may report the following error message.

"Your Exchange Server administrator has blocked the version of Outlook that you are using. Contact your administrator for assistance."

<div>

## For More Information

The error generated by Microsoft Remote Connectivity Analyzer isn't necessarily indicative of a problem. Prohibiting clients from connecting using MAPI is a legitimate configuration option. However, if you ran Microsoft Remote Connectivity Analyzer because you have Outlook clients who are unable to successfully connect, then you will need to modify the setting that prohibits MAPI clients from connecting.

To determine whether MAPI is disabled for your mailbox, run the following command:

    Get-CASMailbox MailboxName | FL mapienabled

If the command returns $false, then you must enable MAPI for your mailbox or choose an alternative connection method. To enable MAPI for your mailbox, run the following command:

    Set-CASMailbox MailboxName -mapienabled:$true

For more information, see [When You Use Outlook With an Exchange 2007 Mailbox, You Cannot Connect to Exchange 2007, and You Receive an Error Message](https://go.microsoft.com/fwlink/?linkid=100100).

The Microsoft Remote Connectivity Analyzer has limited documentation at this time. In an effort to improve the documentation for each of the errors you might receive, we would like to solicit additional information from the community. Please use the Community Content section below to post additional reasons why you failed at this point. If you need technical assistance, please create a post in the appropriate [Exchange TechNet forum](https://go.microsoft.com/fwlink/?linkid=73420) or contact [support](https://go.microsoft.com/fwlink/?linkid=8158).

</div>

<div>

## See Also

#### Other Resources

[Set-CASMailbox](https://technet.microsoft.com/library/bb125264.aspx)  
  

</div>

</div>

<span> </span>

</div>

</div>

</div>

